---
title: "Evolution of solar energy production and use."
author: "Laia Porcar, Luis Marcos LÃ³pez, Philippe Robert"
date: "11/08/2022"
output:
  html_document:
    keep_md: yes
    toc: yes
    df_print: kable
  pdf_document:
    toc: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(warn=-1)
```


```{r, results="hide", message = FALSE}
# Installs
#install.packages("caret")
#install.packages("car")
#install.packages("ggplot2")
#install.packages("devtools")


# Libraries
library(knitr)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(devtools) 
library(caret)
library(car)
library(kableExtra)
library(ggpubr)

```



```{r results = 'asis'}
# Read the dataset
file_path <- getwd()
paste(file_path)

df_capac <- read.csv(paste0(file_path, "/installed-solar-PV-capacity.csv"),header=TRUE)
df_capit <- read.csv(paste0(file_path, "/per-capita-solar.csv"),header=TRUE)
df_prim <- read.csv(paste0(file_path, "/primary-energy-consumption-from-solar.csv"),header=TRUE)
df_shar <- read.csv(paste0(file_path, "/share-electricity-solar.csv"),header=TRUE)
df_consump <- read.csv(paste0(file_path, "/solar-energy-consumption.csv"),header=TRUE)
df_cumcapac <- read.csv(paste0(file_path, "/solar-pv-cumulative-capacity.csv"),header=TRUE)
df_pris <- read.csv(paste0(file_path, "/solar-pv-prices.csv"),header=TRUE)

df_capac[1:150,] %>%
  kable(format = "html", col.names = colnames(df_capacity)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_capit[1:150,] %>%
  kable(format = "html", col.names = colnames(df_capita)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_prim[1:150,] %>%
  kable(format = "html", col.names = colnames(df_primary)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_shar[1:150,] %>%
  kable(format = "html", col.names = colnames(df_share)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_consump[1:150,] %>%
  kable(format = "html", col.names = colnames(df_consump)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_cumcapac[1:150,] %>%
  kable(format = "html", col.names = colnames(df_cumcap)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

df_pris[1:150,] %>%
  kable(format = "html", col.names = colnames(df_prices)) %>%
  kable_styling() %>%
  kableExtra::scroll_box(width = "100%", height = "300px")

```


```{r results = 'asis'}

# to_eliminate <- c('Africa', 'Africa (BP)', 'Asia', 'Asia Pacific (BP)', 'CIS (BP)'
#                   'Europe', 'Europe (BP)', 'High-income countries',
#                   'Lower-middle-income countries', 'Middle East (BP)',
#                   'North America', 'North America (BP)', 'Oceania', 'Other Africa (BP)',
#                   'Other Asia Pacific (BP)', 'Other CIS (BP)', 'Other Europe (BP)',
#                   'Other Middle East (BP)', 'Other South and Central America (BP)',
#                   'South and Central America (BP)', 'Upper-middle-income countries')
# 
# df_capacity_2 <- subset(df_capacity, !(Entity %in% to_eliminate))


df_capacity <- subset(df_capac, Entity = 'World')
df_capacity <- df_capacity %>% group_by(Year) %>% 
  summarise(Solar.Capacity=sum(df_capac$Solar.Capacity))

df_capita <- subset(df_capit, Entity = 'World')
df_capita <- df_capita %>% group_by(Year) %>% 
  summarise(Solar.Per.Capita=sum(df_capit$Solar.per.capita..kWh...equivalent.))

df_primary <- subset(df_prim, Entity = 'World')
df_primary <- df_primary %>% group_by(Year) %>% 
  summarise(Solar.TWh.Equivalent=sum(df_prim$Solar..TWh...equivalent.))

df_share <- df_shar %>% group_by(Year) %>% 
  summarise(Solar.TWh.Equivalent=sum(df_shar$Solar..TWh...equivalent.))

df_consumption <- subset(df_consump, Entity = 'World')
df_consumption <- df_consumption %>% group_by(Year) %>% 
  summarise(Electricity.consumption.TWh=sum(df_consump$Electricity.from.solar.TWh.))

df_cumcap <- subset(df_cumcapac, Entity = 'World')
df_cumcap <- df_cumcap %>% group_by(Year) %>% 
  summarise(Cumulative.Capacity = sum(df_cumcap$Solar.Capacity))

df_price <- subset(df_pris, Entity = 'World')
df_price <- df_price %>% group_by(Year) %>% 
  summarise(Price.PV.Module = sum(df_pris$Solar.PV.Module.Cost..2019.US..per.W.))


# Merge datasets

df <- merge(df_capacity,df_capita,by="Year")
df <- merge(df,df_primary,by="Year")
df <- merge(df,df_share,by="Year")
df <- merge(df,df_consumption,by="Year")
df <- merge(df,df_cumcap,by="Year")
df <- merge(df,df_price,by="Year")
df

```